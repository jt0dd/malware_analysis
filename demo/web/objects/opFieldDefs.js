module.exports = [
  (byte, flags) => {
    console.log("byte", byte);
    console.log("flags", flags);
    if (flags[7] === 0 && flags[6] === 1 && flags[5] === 0 && flags[4] === 0) {
        console.log('REX prefix detected')
        return {
            field: 'REX',
            byte: byte,
            flags: flags,
            props: {
                w: flags[3], // 0 = operand size determined by CS.D, 1 = 64 bit operand size
                r: flags[2], // extension of the ModR/M reg field
                x: flags[1], // extension of the SIB index field
                b: flags[0], // extension of the ModR/M field, SIB base field, or Opcode reg field
            }
        }
    }
    return false;
  },
];
